# SQL_projects_cluster
## Оглавление
- [Задания day00](#задания-day00)
- [Задания day01](#задания-day01)
- [Задания day02](#задания-day02)
- [Задания day03](#задания-day03)
- [Задания day04](#задания-day04)
- [Задания day05](#задания-day05)
- [Задания day06](#задания-day06)
- [Задания day07](#задания-day07)
- [Задания day08](#задания-day08)
- [Задания day09](#задания-day00)
- [Задания team00](#задания-team00)
- [Задания team01](#задания-team01)
- [Установка](#Установка)

## Задания day00
#### SQL Learning Exercises: Basic Query Practice
Серия упражнений по освоению базового SQL синтаксиса. Выполнены запросы на выборку данных с фильтрацией, сортировкой, использованием операторов BETWEEN, обработкой дат, условными конструкциями CASE и подзапросами. Практика работы с JOIN заменена вложенными запросами согласно ограничениям задач.<br>
Ключевые навыки:<br>
- Фильтрация WHERE и сортировка ORDER BY
- Операторы сравнения и BETWEEN
- Работа с датами и дубликатами (DISTINCT)
- Форматирование строк и условные выражения CASE
- Подзапросы в SELECT и FROM секциях
- Работа с четными идентификаторами (MOD)

## Задания day01
### SQL Advanced Queries: UNION, JOINs and Set Operations
Практика работы с операциями над множествами: UNION, INTERSECT, EXCEPT. Реализация различных типов JOIN (INNER, NATURAL), декартового произведения и подзапросов с IN/EXISTS. Анализ данных через объединение таблиц person, menu, pizzeria, person_order, person_visits.<br>
Ключевые навыки:<br>
- Объединение результатов из разных таблиц через UNION
- Нахождение пересечений и разностей множеств
- Все виды JOIN с сортировкой и форматированием
- Замена JOIN на NATURAL JOIN и подзапросы
- Обработка дубликатов и сложная сортировка

## Задания day02
### SQL Data Analysis: Complex Filtering and CTE
Практика анализа данных с использованием продвинутых SQL-техник. Решение задач на поиск пропущенных дат через generate_series и CTE, работа с FULL JOIN для выявления отсутствующих посещений, анализ предпочтений в пиццах. Реализация сложных фильтров по полу, возрасту, городу и ценам с множественными условиями.<br>
Основные навыки:<br>
- Генерация последовательностей дат и CTE
- FULL JOIN с обработкой NULL значений
- Сложные условия в WHERE с AND/OR
- Анализ пересечений (любимые пиццы)
- Поиск людей по общему адресу
- Многоуровневая сортировка результатов

## Задания day03
### SQL Data Modification and Analysis: DML Operations
Практика работы с данными: сложные запросы на анализ цен, посещений и заказов с использованием UNION ALL, EXCEPT, INTERSECT. Реализация операций вставки (INSERT), обновления (UPDATE) и удаления (DELETE) данных. Автоматическое вычисление идентификаторов через подзапросы. Генерация массовых заказов с помощью generate_series.<br>
Ключевые навыки:<br>
- Модификация данных через INSERT/UPDATE/DELETE
- Автоматическое вычисление ID (MAX + 1)
- Анализ гендерных предпочтений в посещениях
- Поиск дубликатов цен в разных пиццериях
- Массовые операции с данными через INSERT-SELECT
- Восстановление базы данных после тестовых изменений

## Задания day04
### SQL Views and Materialized Views: Data Virtualization
Практика создания и использования представлений (Views) и материализованных представлений (Materialized Views). Реализация виртуальных таблиц для разделения данных по полу, генерации дат, поиска пропущенных посещений и симметричной разности множеств. Расчет скидок через представления и обновление материализованных представлений.<br>
Ключевые навыки:<br>
- Создание обычных и материализованных представлений
- Генерация последовательностей дат в представлениях
- Операции с множествами (UNION, EXCEPT)
- Расчетные поля и преобразование типов в представлениях
- Обновление материализованных представлений (REFRESH)
- Управление жизненным циклом представлений (DROP)

## Задания day05
### SQL Index Optimization: B-Tree and Performance Tuning
Практика создания и оптимизации индексов в PostgreSQL. Реализация B-Tree индексов для внешних ключей, функциональных выражений (UPPER), многоколоночных и частично уникальных индексов. Анализ производительности через EXPLAIN ANALYZE для доказательства эффективности индексов. Оптимизация оконных функций и сложных запросов.<br>
Ключевые навыки:<br>
- Создание индексов для внешних ключей
- Функциональные индексы (UPPER)
- Многоколоночные индексы для составных условий
- Уникальные и частично уникальные индексы
- Анализ планов выполнения запросов
- Оптимизация производительности через покрывающие индексы

## Задания day06
### SQL Data Modeling: Discount System Implementation
Проектирование и реализация системы персональных скидок в базе данных. Создание таблицы person_discounts с внешними ключами, расчет динамических скидок на основе истории заказов (10.5% для 1 заказа, 22% для 2, 30% для 3+). Оптимизация через многоколоночный уникальный индекс и ограничения целостности (NOT NULL, CHECK). Автоматизация генерации первичных ключей с помощью последовательностей (SEQUENCE). Добавление комментарией для документирования бизнес-логики.<br>
Ключевые элементы:<br>
- DDL: создание таблиц, ограничений, индексов и последовательностей
- DML: массовая вставка данных с агрегацией и оконными функциями
- Расчет скидок с использованием условной логики
- Обеспечение целостности данных через constraints
- Документирование структуры базы данных

## Задания day07
### SQL Data Aggregation: Advanced Analytics and Metrics
Практика сложной агрегации данных с использованием оконных функций, объединения множеств и условной логики. Расчет ключевых метрик: количество посещений, заказов, средние/максимальные/минимальные цены, рейтинги. Реализация аналитических запросов с фильтрацией групп (HAVING), преобразованием типов и сравнением вычисляемых показателей.<br>
Ключевые навыки:<br>
- Агрегатные функции с группировкой (COUNT, AVG, MAX, MIN)
- Условная фильтрация групп через HAVING
- Объединение данных из разных источников (UNION ALL)
- Округление числовых значений (ROUND)
- Сравнение вычисляемых формул с средними значениями
- Сложная сортировка по нескольким полям

## Задания day08
### SQL Transaction Isolation: Concurrency Anomalies Study
Практическое исследование проблем параллельного доступа в СУБД PostgreSQL. Воспроизведение и анализ классических аномалий: Lost Update, Non-Repeatable Reads, Phantom Reads и Deadlock. Эксперименты с разными уровнями изоляции (Read Committed, Repeatable Read, Serializable). Демонстрация видимости изменений между сессиями до и после COMMIT.<br>
Ключевые аспекты:<br>
- Работа с параллельными сессиями в psql
- Управление транзакциями (BEGIN, COMMIT)
- Сравнение уровней изоляции
- Воспроизведение классических аномалий
- Анализ блокировок и deadlock ситуаций

## Задания day09
### SQL Functions and Triggers: Advanced Database Automation
Практика создания триггеров для аудита изменений (INSERT, UPDATE, DELETE) в таблице person с сохранением истории в person_audit. Реализация SQL и PL/pgSQL функций: параметризованные фильтры по полу, поиск пиццерий по бюджету и дате, вычисление минимума из массива, генерация последовательности Фибоначчи. Оптимизация через объединение триггеров и удаление устаревших объектов.<br>
Ключевые навыки:<br>
- Создание триггерных функций для DML-аудита
- Работа с OLD/NEW записями в триггерах
- Написание SQL и PL/pgSQL функций
- Параметры по умолчанию и VARIADIC массивы
- Рекурсивные вычисления (Фибоначчи)
- Замена представлений на функции

## Задания team00
### SQL Recursive Queries: Traveling Salesman Problem (TSP)
Решение классической задачи коммивояжера (TSP) с использованием рекурсивных SQL-запросов. Поиск оптимального маршрута через все города с минимальной и максимальной стоимостью. Реализация обхода графа с возвратом в начальную точку. Сортировка результатов по общей стоимости и порядку посещения городов.<br>
Ключевые элементы:<br>
- Рекурсивные CTE для генерации всех возможных путей
- Расчет общей стоимости маршрутов
- Фильтрация путей с посещением всех городов
- Возврат в начальную точку (цикличность)
- Сравнение минимальных и максимальных стоимостей
- Сортировка по cost и порядку городов

## Задания team01
### SQL Data Warehousing: Complex Aggregation and Currency Conversion
Решение задач построения витрин данных из независимых источников с аномалиями. Обработка NULL-значений, временных данных курсов валют и транзакций балансов. Реализация сложных запросов с агрегацией, поиском ближайшего курса валют во времени и конвертацией в USD. Сортировка результатов по пользователям и типам балансов.<br>
Ключевые навыки:<br>
- Агрегация данных из нескольких источников с аномалиями
- Обработка NULL значений (COALESCE)
- Временные запросы с поиском ближайшего курса валют
- Конвертация валют с использованием исторических rates
- Многоуровневая сортировка результатов
- Работа с временными метками обновлений

## Установка
```
git clone
cd SQL_projects_cluster/src

# в каждом day или team находится директория materials, в которой лежит скрипт с моделью базы данных
# пожалуйста, загружайте себе нужную модель для корректной работы sql - скриптов
```
